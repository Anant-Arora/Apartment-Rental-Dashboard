{% extends 'base.html' %}
{% block title %}Manage Apartments{% endblock %}

{% block script %}
    <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
    <!-- We will create this CSS file in the next step -->
    <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='css/ApartmentRoomsAdminStyle.css')}}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="main-content-area">
    
    <!-- Display Flashed Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Add New Apartment Form -->
    <div class="form-container card-shadow">
        <header class="form-header">
            <h1>Add a New Property</h1>
        </header>
        <form action="{{ url_for('ApartmentRooms') }}" method="post" enctype="multipart/form-data" class="property-form">
            <!-- Form fields go here -->
            <div class="form-row">
                <div class="form-group">
                    <label for="room">Apartment / Room No.</label>
                    <input type="text" id="room" name="room" required>
                </div>
                <div class="form-group">
                    <label for="block">Block No.</label>
                    <input type="text" id="block" name="block" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="rentPerMonth">Rent Per Month (₹)</label>
                    <input type="number" id="rentPerMonth" name="rentPerMonth" required>
                </div>
                <div class="form-group">
                    <label for="area">Area (sq. ft.)</label>
                    <input type="number" id="area" name="area" required>
                </div>
            </div>
            <div class="form-group">
                <label for="apartmentTitle">Property Title</label>
                <input type="text" id="apartmentTitle" name="apartmentTitle" placeholder="e.g., 2BHK with Balcony" required>
            </div>
            <div class="form-group">
                <label for="desc">Description</label>
                <textarea id="desc" name="desc" rows="3" required></textarea>
            </div>
            <div class="form-group">
                <label>Status</label>
                <select name="status" required>
                    <option value="Unoccupied">Unoccupied</option>
                    <option value="Occupied">Occupied</option>
                </select>
            </div>
            <div class="form-group">
                <label>Upload Photos</label>
                <div class="file-uploads">
                    <span>Living Room / Hall*</span><input type="file" name="hall" required>
                    <span>Kitchen*</span><input type="file" name="kitchen" required>
                    <span>Bedroom*</span><input type="file" name="bedroom" required>
                    <span>Extra Photo</span><input type="file" name="extra">
                </div>
            </div>
            <button type="submit" class="submit-btn">Add Property</button>
        </form>
    </div>

    <!-- Table of Existing Apartments -->
    <div class="table-container card-shadow">
        <header class="form-header">
            <h1>Existing Properties</h1>
        </header>
        <table class="property-table">
            <thead>
                <tr>
                    <th>Room No.</th>
                    <th>Title</th>
                    <th>Block No.</th>
                    <th>Rent (₹)</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for apt in apartments %}
                <tr>
                    <td>{{ apt.ROOM_NO }}</td>
                    <td>{{ apt.APT_TITLE }}</td>
                    <td>{{ apt.BLOCK_NO }}</td>
                    <td>{{ apt.RENT_PER_MONTH }}</td>
                    <td>{{ apt.APT_STATUS }}</td>
                    <td class="actions">
                        <!-- Simple form for deletion -->
                        <form action="{{ url_for('DeleteApartment') }}" method="post" onsubmit="return confirm('Are you sure you want to delete this apartment?');">
                            <input type="hidden" name="room2" value="{{ apt.ROOM_NO }}">
                            <button type="submit" class="btn-delete"><i class="fas fa-trash-alt"></i></button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>
{% endblock %}